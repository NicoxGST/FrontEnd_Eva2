
<div class="lecturas-container">
    <h2 class="title">ğŸ‘¤ GestiÃ³n de Clientes</h2>
  <form [formGroup]="clienteForm" (ngSubmit)="guardar()" class="lectura-form card" style="margin-bottom:2rem;">
    <div class="form-group">
      <label for="rut">RUT</label>
      <input id="rut" type="text" formControlName="rut" placeholder="Ej: 12.345.678-9" />
    </div>
    <div class="form-group">
      <label for="nombre_razon">Nombre/RazÃ³n Social</label>
      <input id="nombre_razon" type="text" formControlName="nombre_razon" placeholder="Ej: Juan PÃ©rez" />
    </div>
    <div class="form-group">
      <label for="email_contacto">Email</label>
      <input id="email_contacto" type="email" formControlName="email_contacto" placeholder="Ej: correo@dominio.com" />
    </div>
    <div class="form-group">
      <label for="telefono">TelÃ©fono</label>
      <input id="telefono" type="text" formControlName="telefono" placeholder="Ej: +56912345678" />
    </div>
    <div class="form-group full">
      <label for="direccion_facturacion">DirecciÃ³n</label>
      <input id="direccion_facturacion" type="text" formControlName="direccion_facturacion" placeholder="Ej: Calle 123, Ciudad" />
    </div>
    <div class="form-group">
      <label for="estado">Estado</label>
      <select id="estado" formControlName="estado">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">{{ editingId ? 'Actualizar' : 'Guardar' }}</button>
      <button type="button" (click)="limpiar()" class="btn btn-secondary">Limpiar</button>
    </div>
  </form>
  <div *ngIf="mensaje" class="mensaje-exito">
    <span class="material-icons icono">check_circle</span>
    {{ mensaje }}
  </div>
  <div *ngIf="error" class="mensaje-error">
    <span class="material-icons icono">error_outline</span>
    {{ error }}
  </div>


  <!-- Buscador y paginaciÃ³n -->
  <div class="card table-card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; flex-wrap: wrap; gap: 1rem;">
      <h3>ğŸ‘¥ Lista de Clientes</h3>
  <input type="text" [(ngModel)]="filtro" (ngModelChange)="guardarFiltro($event)" [attr.list]="'sugerenciasFiltro'" placeholder="Buscar por RUT o Nombre" style="padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid #dfe4ea; min-width: 220px;" (click)="mostrarSugerencia($event)" autocomplete="off" />
      <datalist id="sugerenciasFiltro">
        <option *ngFor="let s of sugerenciasFiltro" [value]="s"></option>
      </datalist>
      <div>
        <label for="pageSize" style="margin-right: 8px; font-weight: 500;">Mostrar:</label>
        <select id="pageSize" [(ngModel)]="pageSize" style="padding: 0.4rem 0.8rem; border-radius: 8px; border: 1px solid #dfe4ea;">
          <option [value]="5">5</option>
          <option [value]="10">10</option>
          <option [value]="15">15</option>
        </select>
      </div>
    </div>
    <table class="lecturas-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>RUT</th>
          <th>Nombre</th>
          <th>Email</th>
          <th>TelÃ©fono</th>
          <th>DirecciÃ³n</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let c of clientesFiltrados | slice:(paginaActual-1)*pageSize:(paginaActual-1)*pageSize+pageSize">
          <td>{{ c.id_cliente || 'â€”' }}</td>
          <td>{{ c.rut || 'â€”' }}</td>
          <td>{{ c.nombre_razon || 'â€”' }}</td>
          <td>{{ c.email_contacto || 'â€”' }}</td>
          <td>{{ c.telefono || 'â€”' }}</td>
          <td>{{ c.direccion_facturacion || 'â€”' }}</td>
          <td>
            <span [ngClass]="{'estado-activo': c.estado === 'activo', 'estado-inactivo': c.estado === 'inactivo'}">
              {{ c.estado || 'â€”' }}
            </span>
          </td>
          <td class="actions">
            <button (click)="editar(c)" class="btn-action edit" title="Editar">âœï¸</button>
            <button (click)="eliminar(c.id_cliente)" class="btn-action delete" title="Eliminar">ğŸ—‘ï¸</button>
          </td>
        </tr>
        <tr *ngIf="clientesFiltrados.length === 0">
          <td colspan="8" class="empty">Sin clientes registrados</td>
        </tr>
      </tbody>
    </table>
    <!-- PaginaciÃ³n -->
    <div style="display: flex; justify-content: flex-end; align-items: center; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap;">
      <button class="btn btn-secondary" [disabled]="paginaActual === 1" (click)="paginaActual = paginaActual - 1">Anterior</button>
      <span>PÃ¡gina {{ paginaActual }} de {{ totalPaginas }}</span>
      <button class="btn btn-secondary" [disabled]="paginaActual === totalPaginas" (click)="paginaActual = paginaActual + 1">Siguiente</button>
    </div>
  </div>
</div>

