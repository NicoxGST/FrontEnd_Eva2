
<div class="lecturas-container">
  <div *ngIf="mensaje" class="mensaje-exito">
    <span class="material-icons icono">check_circle</span>
    {{ mensaje }}
  </div>
  <div *ngIf="error" class="mensaje-error">
    <span class="material-icons icono">error_outline</span>
    {{ error }}
  </div>
  <h2 class="title">ğŸ”Œ GestiÃ³n de Medidores</h2>
  <form [formGroup]="medidorForm" (ngSubmit)="guardar()" class="lectura-form card" novalidate>
    <div class="form-group">
      <label for="codigo_medidor">CÃ³digo del Medidor</label>
      <input id="codigo_medidor" type="text" formControlName="codigo_medidor" placeholder="Ej: MED-1234" />
    </div>
    <div class="form-group">
      <label for="id_cliente">Cliente asociado</label>
      <select id="id_cliente" formControlName="id_cliente">
        <option value="">Seleccione un cliente</option>
        <option *ngFor="let cliente of clientes" [value]="cliente.id_cliente">
          {{ cliente.nombre_razon }}
        </option>
      </select>
    </div>
    <div class="form-group">
      <label for="direccion_suministro">DirecciÃ³n de suministro</label>
      <input id="direccion_suministro" type="text" formControlName="direccion_suministro" placeholder="DirecciÃ³n completa" />
    </div>
    <div class="form-group">
      <label for="estado">Estado</label>
      <select id="estado" formControlName="estado">
        <option value="activo">Activo</option>
        <option value="inactivo">Inactivo</option>
      </select>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        {{ editando ? 'Actualizar' : 'Guardar' }}
      </button>
      <button type="button" (click)="limpiar()" class="btn btn-secondary">Limpiar</button>
    </div>
  </form>
  <div class="card table-card">
    <h3>ğŸ“‹ Lista de Medidores</h3>
    <table class="lecturas-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>CÃ³digo</th>
          <th>Cliente</th>
          <th>DirecciÃ³n</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let m of medidores">
          <td>{{ m.id_medidor }}</td>
          <td>{{ m.codigo_medidor }}</td>
          <td>{{ getClienteNombre(m.id_cliente) }}</td>
          <td>{{ m.direccion_suministro }}</td>
          <td>
            <span [ngClass]="{'estado-activo': m.estado === 'activo', 'estado-inactivo': m.estado === 'inactivo'}">
              {{ m.estado }}
            </span>
          </td>
          <td class="actions">
            <button (click)="editar(m)" class="btn-action edit">âœï¸</button>
            <button (click)="eliminar(m.id_medidor)" class="btn-action delete">ğŸ—‘ï¸</button>
          </td>
        </tr>
        <tr *ngIf="medidores.length === 0">
          <td colspan="6" class="empty">Sin medidores registrados</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
